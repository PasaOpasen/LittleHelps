#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body)))
View(d2)
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body))) %>% select(-Date,-Mail)
View(d2)
ob=ggplot(d2,aes(y=res))
ob+geom_boxplot(aes(x=Type))
ob+geom_boxplot(aes(x=Body))
ob+geom_histogram()
ob+geom_histogram(aes(x=Val))
ob+geom_bar(aes(x=allrows))
ob+geom_bar(aes(x=factor(allrows)))
ob+geom_point(aes(x=allrows))
ob+geom_point(aes(x=allrows,col=factor(ifelse(abs(y)>2,"red","green"))))
ob+geom_point(aes(x=allrows,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,size=4,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))),size=4)
ob+geom_boxplot(aes(x=Body))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
ggplot(d2,aes(SM))+geom_line()
ggplot(d2,aes(x=allrows,y=SM))+geom_line()
mx=function(vals,count){
t=val*(1+0.0333*count)
t[count==1]=val[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,5,4)
mx(x,y)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,5,4)
mx(x,y)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
mx(x,y)
vc=c(mx(x,y),mx(x+5,y))
plot(vc)
vc
library(tidyverse)
library(magrittr)
library(ggformula)
tb=tibble(d=1:length(vc),val=vc)
ggplot(tb,aes(x=d,y=val))+
geom_spline()+
geom_point()
ggplot(tb,aes(x=d,y=val))+
geom_spline(spar=0.8)+
geom_point(size=3)
ggplot(tb,aes(x=d,y=val))+
geom_spline(spar=0.1)+
geom_point(size=3)
f=spline(vc)
spline()
f
f=spline(vc,n=40)
ggplot(tb,aes(x=d,y=val))+
geom_line(aes(x=f$x,y=f$y))+
geom_point(size=3)
ggplot(tb)+
geom_line(aes(x=f$x,y=f$y))+
geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=f$x,y=f$y))#+
#geom_point(aes(x=d,y=val),size=3)
f$x
f$y
tb=tibble(f)
View(tb)
tb=tibble(x=f$x,y=f$y)
ggplot(tb)+
geom_line(aes(x=x,y=y))#+
#geom_point(aes(x=d,y=val),size=3)
f=spline(vc,n=40)
tb=tibble(d=f$x,val=f$y)
ggplot(tb)+
geom_line(aes(x=d,y=val))#+
#geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
#geom_point(aes(x=d,y=val),size=3)
tb=tibble(d=f$x,val=f$y,day=ifelse(d==1:length(vc),1,0))
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
View(tb)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)#+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=1:length(vc),y=vc),size=3)
ggplot()+
geom_line(tb,aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=1:length(vc),y=vc),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day)))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2)))
f=spline(vc,n=40,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2)))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(day,levels = c("green","red"))))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=60,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=50,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=20,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=40,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=40)
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
library(tidyverse)
library(magrittr)
library(ggformula)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+5,y))
f=spline(vc,n=40)
tb=tibble(d=1:length(vc),val=vc,day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_line(data=data.frame(f))
tb=tibble(d=1:length(vc),val=vc,day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_line(data=data.frame(f))
tb=data.frame(d=1:length(vc),val=vc,day=ifelse(d%%length(x)==0,1,0))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_line(data=data.frame(f))
View(tb)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_line(data=data.frame(f))
ggplot(tb,aes(x=d,y=val))+
geom_point()+
geom_line(data=data.frame(f))
tb
ggplot(tb,aes(x=d,y=val))+
geom_point()#+
ggplot(tb,aes(x=d,y=val))+
geom_point()+
geom_line(data=data.frame(spline(tb, n=n*10)))
ggplot(tb,aes(x=d,y=val))+
geom_point()+
geom_line(data=data.frame(spline(tb, n=40)))
tb=tibble(d=1:length(vc),val=vc) #%>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_point()+
geom_line(data=data.frame(spline(tb, n=40)))
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_line(data=data.frame(spline(tb, n=40)))
f=spline(vc,n=40)
tb=tibble(x=1:length(vc),y=vc) #%>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_line(data=data.frame(spline(tb, n=40)))
install.packages("ggalt")
library(ggalt)
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_xspline(size=0.2)
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_xspline(size=0.7)
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_xspline(size=13)
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_xspline(size=1.2)
ggplot(tb,aes(x=x,y=y))+
geom_point()+
geom_xspline(size=1.1)
tb=tibble(x=1:length(vc),y=vc) %>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=x,y=y))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
tb=tibble(x=1:length(vc),y=vc) %>% mutate(day=ifelse(x%%length(x)==0,1,0))
ggplot(tb,aes(x=x,y=y))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
View(tb)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,val=y))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=ifelse(d%%length(x)==0,1,0))
ggplot(tb,aes(x=d,y=val))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)==0,1,0)))
ggplot(tb,aes(x=d,y=val))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.01,0.04))
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+5,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)+1==0,"проходка","тренировка")))
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggalt)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)+1==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.01,0.04))
return(с(t),s)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+5,y))
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.01,0.04))
return(с(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+5,y))
mx(x,y)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.01,0.04))
return(c(t,s))
}
vc=c(mx(x,y),mx(x+5,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)+1==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_point(aes(col=day),size=3)+
geom_xspline(size=1)
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.01,0.02))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.02))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggalt)
#простой цикл####
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.02))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)+theme_bw()
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.01))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)+theme_bw()
#простой цикл####
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.005))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 1)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.2)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.4,line_type="dash")+
geom_point(aes(col=day),size=4)+theme_bw()
vignette("ggplot2-specs")
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.6,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.5,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.7,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = 0.8,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.8,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.5,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dashed")+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",alpha=0.5)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",alpha=0.7)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="orange",alpha=0.7)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="gold",alpha=0.7)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="orange",alpha=0.7)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="orange",alpha=0.8)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="orange",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="red",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 140)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142)+
geom_hline(yintercept = vc[length(vc)])+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142,show.legend = T)+
geom_hline(yintercept = vc[length(vc)])+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142,size=1.2)+
geom_hline(yintercept = vc[length(vc)])+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142,size=1.2,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)])+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142,size=1.2,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.2,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 142,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
mx2=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
#155
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx2(x,y),mx2(x+7.5,y),mx2(x+15,y))
plot(vc)
plot(vc,type = "b")
vc=c(mx2(x,y),mx2(x+8,y),mx2(x+15,y))
plot(vc,type = "b")
x=c(112,112,117,122,126,131,136,141,145,150,155,160,166,177,122.5,122.5,128,133,138,143,149,154,159,165,170,175,182,195,136,136,142,148,154,160,165,171,177,183,190,195,203,216)
y=rep(c(10,10,8,8,5,5,5,5,3,3,2,2,1,1),3)
vc=c(mx2(x,y))
plot(vc,type = "b")
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.005))
return(c(t,s))
}
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
