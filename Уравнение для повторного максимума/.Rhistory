maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,High,Body,Experience,Sex,IndexGroup) %>% unique()
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>%#filter(Count<=20) %>%
arrange(Val,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*High)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,Val<SM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,High,Body,Experience,Sex,IndexGroup) %>% unique()
data.unique %$%  table(Body,IndexGroup)
data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1",1,0)) %>%select(Body,Obees) %>% table()
chisq.test(data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1",1,0)) %>%select(Body,Obees) %>% table())
data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1",1,0)) %>%select(Obees,Body) %>% table()
data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет")) %>%select(Obees,Body) %>% table()
chisq.test(data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет")) %>%select(Obees,Body) %>% table())
chisq.test(data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет")) %>%select(Obees,Body) %>% table()) %>% summary()
tb=data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет")) %>%select(Obees,Body) %>% table()
tb %>% chisq.test()
tb=data.unique%>% mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет")) %>%select(Obees,Body) %>% table()
tb %>% chisq.test()
tb
tb %>% chisq.test(p=c(0.25,0.25,0.5))
tb %>% chisq.test(p=c(0.25,0.25,0.5),rescale.p = T)
tb %>% chisq.test(p=c(0.25,0.25,0.5),rescale.p = T)
tb %>% chisq.test(p=c(1,1,1),rescale.p = T)
tb %>% chisq.test(p=c(1,1,2),rescale.p = T)
tb %>% chisq.test(p=c(1,1,20),rescale.p = T)
tb %>% prop.test()
tb %>% t() %>% prop.test()
tb %>% t() %>% prop.test() %>% summary()
tb %>% t() %>% prop.test() %>% str()
tb %>% t() %>% prop.test() %$% conf.int
tb %>% t() %>% prop.test(alternative = "greather") %$% conf.int
tb %>% t() %>% prop.test(alternative = "greater") %$% conf.int
tb %>% t() %>% prop.test(alternative = "greater",correct = F) %$% conf.int
tb %>% t() %>% prop.test(alternative = "greater",correct = F)
tb %>% t() %>% prop.test(alternative = "less",correct = F) %$% conf.int
tb %>% t() %>% prop.test(correct = F) %$% conf.int
tb %>% t() %>% prop.test(correct = F) %$% conf.level
tb %>% t() %>% prop.test(conf.level = 0.99,correct = F) %$% conf.int
tb %>% t() %>% prop.test(conf.level = 0.4,correct = F) %$% conf.int
tb %>% t() %>% prop.test(conf.level = 0.99,correct = F) %$% conf.int
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эктоморф',1,0)) %>%
select(Obees,Bd) %>% table()
tb
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эктоморф',1,0)) %>%
select(Obees,Bd)
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эктоморф',1,0)) %>%
select(Obees,Bd) %>% table()
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эндоморф',1,0)) %>%
select(Obees,Bd) %>% table()
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эндоморф',1,0)) %>%
select(Obees,Bd) %>% table() %>% t() %>%
prop.test(conf.level = 0.99,correct = F)
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эндоморф',1,0)) %>%
select(Obees,Bd) %>% table() %>% t() %>%
prop.test(conf.level = 0.99,correct = F) %$% conf.int
data.unique%>%
mutate(Obees=ifelse(IndexGroup=="ожирение1","да","нет"),Bd=ifelse(Body=='Эндоморф',1,0)) %>%
select(Obees,Bd) %>% table() %>% t() %>%
prop.test(correct = F) %$% conf.int
data.unique %$%  table(Body,IndexGroup)
psych::describe(data)
summary(data)
data %>% mutate(perc=100*Val/SM) %>% filter(Count<=15) %>%
group_by(factor(Count)) %>%
summarise(mean=t.test(perc)$estimate,
down=t.test(perc)$conf.int[1],
up=t.test(perc)$conf.int[2])
data %>% mutate(perc=100*Val/SM) %>% filter(Count<=15) %>%
group_by(factor(Count)) %>%
summarise(mean=t.test(perc,conf.level = 0.999)$estimate,
down=t.test(perc,conf.level = 0.999)$conf.int[1],
up=t.test(perc,conf.level = 0.999)$conf.int[2])
data %>% mutate(perc=100*Val/SM) %>% filter(Count<=15) %>%
group_by(factor(Count)) %>%
summarise(mean=t.test(perc,conf.level = 0.99)$estimate,
down=t.test(perc,conf.level = 0.99)$conf.int[1],
up=t.test(perc,conf.level = 0.99)$conf.int[2])
data %>% ggplot(aes(x=factor(Count),y=100*Val/SM))+geom_boxplot()+coord_flip()+theme_bw()#+
#annotate("text", x=10, y = mean(100*Val/SM), label = "Начальные результаты")
View(data)
sigma=nls(v~1+b/(1+exp(-k*n)),
data=data.frame(v=coefficients(m)[1:7],n=1:7),
start = list(b=0.3,k=1))
# а что если там квадратичная зависимость от 2 до 6?
m=lm(SM~Val:I((Count-1)^2)-1,data %>% filter(Count<7))
sigma=nls(v~1+b/(1+exp(-k*n)),
data=data.frame(v=coefficients(m)[1:7],n=1:7),
start = list(b=0.3,k=1))
# а что если там квадратичная зависимость от 2 до 6?
m=lm(SM~Val:I((Count-1)^2)-1,data %>% filter(Count<7))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
summary(data)
View(data)
pairs(data %>% select(-Count))
GGally::ggpairs(data%>% select(-Count,-Mail),title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
GGally::ggpairs(data%>% select(-Count,-Mail),title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
GGally::ggpairs(data[1:3],#%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
#Загрузка данных####
library(tidyverse)
library(magrittr)
#library(ggformula)
#library(ggthemes)
#library(tidyquant)
#library(ggvis)
#library(plotrix)
#library(car)
#library(DAAG)
#library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
summary(data %>% select(-Mail))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
summary(data %>% select(-Mail))
View(data)
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
#
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
install.packages(c("bit", "bookdown", "broom", "Cairo", "callr", "car", "cli", "covr", "crosstalk", "dendextend", "DescTools", "devtools", "digest", "doBy", "dplyr", "Ecdat", "eiPack", "FactoMineR", "fBasics", "fGarch", "forcats", "foreach", "forecast", "foreign", "fs", "geojsonio", "geojsonlint", "gganimate", "ggformula", "ggplot2", "ggpubr", "ggraph", "ggrepel", "glmnetUtils", "glue", "gplots", "graphlayouts", "gridGraphics", "h2o", "klaR", "lattice", "lava", "lifecycle", "lintr", "manipulateWidget", "matrixStats", "mboost", "MCMCpack", "memisc", "mets", "mice", "mlogit", "ModelMetrics", "modelr", "modeltools", "mongolite", "mvtnorm", "ncvreg", "nlme", "nloptr", "nnet", "osmdata", "party", "partykit", "pbkrtest", "plm", "plotly", "plyr", "pmml", "processx", "proj4", "ps", "pscl", "quantmod", "R.methodsS3", "Rcpp", "RcppArmadillo", "Rcsdp", "remotes", "rgl", "riskRegression", "rlang", "roxygen2", "rstudioapi", "rugarch", "servr", "sfsmisc", "shiny", "shinyWidgets", "sp", "SQUAREM", "statmod", "stringi", "styler", "survival", "testthat", "tidyquant", "tinytex", "tripack", "TSP", "units", "V8", "vcd", "vctrs", "wskm", "xml2"))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
summary(data %>% select(-Mail))
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(continuous = "RMooth_loess", combo = "box"))
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box"))
View(data)
View(data)
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) %>% ggplotly()
library(plotly)
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) %>% ggplotly()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) #%>% ggplotly()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age,Sex,Index),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) #%>% ggplotly()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age,-Sex,-Index),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) #%>% ggplotly()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age,-Sex,-Index,-Height,-CountGroup,-AgeGroup),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list( combo = "box")) #%>% ggplotly()
GGally::ggpairs(data%>% select(-Count,-Mail,-Age,-Sex,-Index,-Height,-CountGroup,-AgeGroup,-Weight),
title="Диаграмы взаимодействий между переменными в выборке",
lower = list(combo = "box")) #%>% ggplotly()
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_wrap(vars(IndexGroup))
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_wrap(vars(IndexGroup),vars(BodyType))
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_wrap(vars(IndexGroup,BodyType))
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_grid(~IndexGroup+BodyType)
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_grid(IndexGroup~BodyType)
ggplot(data,aes(x=Action,y=RM))+geom_boxplot()+facet_wrap(vars(IndexGroup))
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_wrap(vars(Action))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
library(plotrix)
library(car)
#library(DAAG)
library(leaps)
library(plotly)
data=read_tsv("data(rus).tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
comment="#"
) %>% tbl_df()
colnames(data)=c("Date","RM","MRM","Count","Action","Sex","Experience","Age","Weight","Height","BodyType","Mail")
data %<>%#filter(Count<=20) %>%
arrange(MRM,Count,Weight) %>%  mutate(
CountGroup=cut(Count,breaks = c(1,3,6,10,20,40)),
AgeGroup=cut(Age,breaks = c(1,19,27,35,70)),
Experience=factor(Experience,levels = c("До двух лет","2-3 года","4-5 лет","6-10 лет","11-15 лет" ,"больше 15 лет"),ordered = T),
Index=Weight/(0.01*Height)^2,
IndexGroup=cut(Index,breaks = c(0,16,18.5,24.99,30,35,40,60))
)%>% select(-Date)#,-Mail) %>% filter(Count>1,MRM<RM)
levels(data$CountGroup)=c("2-3","4-6","7-10","11-20",">20")
levels(data$AgeGroup)=c("<20","20-27","28-35",">35")
levels(data$IndexGroup)=c("выраженный дефицит","дефицит","норма","избыток","ожирение1","ожирение2","ожирение3")
ex=data$Experience %>% as.numeric()
ex[ex==6]=5
ex %<>%factor()
levels(ex)=c("До двух лет","2-3 года","4-5 лет","6-10 лет","больше 10 лет")
data %<>%mutate(Experience=factor(ex,ordered = T))
allrows=1:nrow(data)
maxerror=2
#уникальные записи (где один от каждого человека берётся только одна запись)
#объяснить, по каким признакам людей считать одинаковыми
data.unique=data %>% select(AgeGroup,Height,BodyType,Experience,Sex,IndexGroup) %>% unique()
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_wrap(vars(Action))
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_wrap(vars(Body))
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_wrap(vars(BodyType))
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_wrap(Action~BodyType)
ggplot(data,aes(x=IndexGroup,y=RM))+geom_boxplot()+facet_grid(Action~BodyType)
ggplot(data,aes(x=Index,y=RM))+geom_boxplot()+facet_grid(Action~BodyType)
ggplot(data,aes(x=Index,y=RM))+geom_point()+facet_grid(Action~BodyType)
ggplot(data,aes(x=Index,y=RM))+geom_point()+facet_grid(Action)
ggplot(data,aes(x=Index,y=RM))+geom_point()+facet_wrap(~Action)
