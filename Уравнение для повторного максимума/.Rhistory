colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)),ValCoef=Val/Weight,SMcoef=SM/Weight)
allrows=1:nrow(data)
summary(data)
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
obj+geom_bar(aes(x=CountGroup))
getPIE=function(vec,main=""){
ln=length(levels(vec))
x=numeric(ln)
ns=character(ln)
for(i in seq(ln)){
x[i]=sum(vec==levels(vec)[i])/length(vec)
ns[i]=paste0(levels(vec)[i]," (",round(x[i]*100,2),"%)")
}
pie(x=x,labels=ns,main=main)
}
getPIE(data$Body)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
car::vif(md)
plot(md)
md=lm(SM~Val:Count+Val:Body:Count+
Val+Val:Body+#Val:Sex+
Val:Experience-1+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=step(md,direction = "backward")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
anove(md)
anova(md)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dashed")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience))) %>% select(-Date,-Mail)
ob=ggplot(d2,aes(y=res))
ob+geom_boxplot(aes(x=Type))
md=lm(SM~Val:Count+#Val:Body:Count+
Val-1+#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val:Count+#Val:Body:Count+
Val-1+#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val:Count+#Val:Body:Count+
Val-1+#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High#,Body,Sex,Experience
)),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High#,Body,Sex,Experience
)),allrows)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=step(md,direction = "backward")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val:Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val:Body+Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
ob+geom_boxplot(aes(x=Body))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))),size=4)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)),ValCoef=Val/Weight,SMcoef=SM/Weight)
allrows=1:nrow(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SMcoef~ValCoef:Count+ValCoef-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count))*data$Weight,allrows)
md=lm(SM~Val+Val:Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+
Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=step(md,direction = "backward")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val*Body+Val:Count+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val*Body+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Count*Weight/(High-100))+
I((Val-100)/Val),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+#Val:Body:Count+
#Val:Body+#Val:Sex+
#Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+I(Val/Weight),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+I(Val/Weight),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body#,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+I(Val/Weight),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+I(Val/Weight),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
poly((Val-100)/Val,3)+poly(Val/Weight,2),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
Error=function(target,weight) (target-weight)^2 %>% sum() %>% ./length(.) %>% sqrt()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum() %>% ./length(target) %>% sqrt()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum() %>% %/%(length(target)) %>% sqrt()
Error=function(target,weight)
{
s=(target-weight)^2 %>% sum()
return(sqrt(s/length(weight)))
}
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=step(md,direction = "both")
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience)),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight*Count,2),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
md=lm(SM~Val+Val:Count-1+Val:Body:Count+Val:Experience:Count+
Val:Body+#Val:Sex+
Val:Experience+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2),
data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience
)),allrows)
ob=ggplot(d2,aes(y=res))
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience))) %>% select(-Date,-Mail)
ob=ggplot(d2,aes(y=res))
ob+geom_boxplot(aes(x=Type))
ob+geom_boxplot(aes(x=Body))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))),size=4)
md=lm(SMcoef~ValCoef:Count+ValCoef-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count))*data$Weight,allrows)
md=lm(SMcoef~ValCoef:Count:CountGroup+ValCoef-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count,CountGroup))*data$Weight,allrows)
md=lm(SMcoef~ValCoef:Count:CountGroup+ValCoef:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count,CountGroup))*data$Weight,allrows)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience,CountGroup), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
md=lm(SMcoef~ValCoef:Count:CountGroup+ValCoef:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count,CountGroup))*data$Weight,allrows)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience,CountGroup), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience,CountGroup), interval = "prediction", level = 0.95)
md=lm(SMcoef~ValCoef:Count:CountGroup+ValCoef:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count,CountGroup))*data$Weight,allrows)
md=lm(SM~Val:Count:CountGroup+Val:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SM~Val:Count:CountGroup+Val:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count,CountGroup)),allrows)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience,CountGroup), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
