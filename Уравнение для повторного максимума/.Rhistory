),steps=5000)
stp=lm(RM~MRM:Count:CountGroup+
MRM:CountGroup+
# MRM:CountGroup:Action+
#MRM:CountGroup:Action2+
# MRM:CountGroup:BodyType+
# MRM:CountGroup:Body2+
MRM:Action+
MRM:Action2+
I(Count^2):MRM-1+
#I(MRM/Weight):Action+
MRM:BodyType:Count+
MRM:Body2:Count+
I(MRM/Weight):Action2+
MRM:Body2:Count+
I(MRM^2)+
sqrt(MRM)+
I(Index/MRM)+
AgeGroup:Experience+
I(MRM/Weight):AgeGroup:Experience+
#I(MRM/Index)+
#I((MRM/Index)^2)+
#I((MRM/Index)^3)+
sqrt(MRM/Index)+
log(MRM/Index)+
poly(MRM/Index,3)+
poly(Index/MRM,3)
,data #%>% filter(Count<11)
) %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=lm(RM~MRM:Count:CountGroup+
MRM:CountGroup+
# MRM:CountGroup:Action+
#MRM:CountGroup:Action2+
# MRM:CountGroup:BodyType+
# MRM:CountGroup:Body2+
MRM:Action+
MRM:Action2+
I(Count^2):MRM-1+
#I(MRM/Weight):Action+
MRM:BodyType:Count+
MRM:Body2:Count+
I(MRM/Weight):Action2+
MRM:Body2:Count+
I(MRM^2)+
sqrt(MRM)+
I(Index/MRM)+
AgeGroup:Experience+
I(MRM/Weight):AgeGroup:Experience+
I(MRM/Index)+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
sqrt(MRM/Index)+
log(MRM/Index)+
#poly(MRM/Index,3)+
poly(Index/MRM,3)
,data #%>% filter(Count<11)
) %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
b3=lm(RM ~ I((MRM/Index)^3) + MRM:CountGroup + MRM:Action + MRM:CountGroup:Count - 1,data)
b3 %>% all()
data%$%plot(MRM/Index,RM)
data%$%plot(MRM/Index,log(RM))
data%$%plot(sqrt(MRM/Index),log(RM))
data%$%plot(MRM/Index,log(RM))
data%$%plot(log(MRM/Index),log(RM))
data%$%plot(exp(MRM/Index),log(RM))
data%$%plot(MRM/Index,RM)
data%$%plot(MRM*Index,RM)
data%$%plot(Index/RM,RM)
data%$%plot(Index/RM,log(RM))
data%$%plot(MRM/Index,log(RM))
data%$%plot(MRM/Index,RM)
data%$%plot(MRM/Index,RM)
lm(RM~MRM/Index,data) %>% summary()
()
lm(RM~MRM/Index-1,data) %>% summary()
lm(RM~I(MRM/Index)-1,data) %>% summary()
lm(RM~poly(MRM/Index,4)-1,data) %>% summary()
lm(RM~poly(MRM/Index,2)-1,data) %>% summary()
lm(RM~poly(MRM/Index,1)-1,data) %>% summary()
lm(RM~I(MRM/Index)+I((MRM/Index)^2)+I((MRM/Index)^3)+I((MRM/Index)^4)+-1,data) %>% summary()
lm(RM~I(MRM/Index)+I((MRM/Index)^2)+I((MRM/Index)^3)+I((MRM/Index)^4)-1,data) %>% summary()
lm(RM~I(MRM/Index)+I((MRM/Index)^2)+I((MRM/Index)^3)+I((MRM/Index)^4)-1,data) %>% all()
lm(RM~I(MRM/Index):Count+I((MRM/Index)^2)-1,data) %>% all()
lm(RM~I(MRM/Index/Count)+I((MRM/Index)^2)-1,data) %>% all()
lm(RM~I(MRM/Index/Count)-1,data) %>% all()
best=lm(RM ~ MRM:Action + MRM:I(Count^2) + Action2:I(MRM/Weight) + MRM:Count:CountGroup - 1,data)
best %>% all()
b2=lm(RM ~ I(MRM/Index) + MRM:CountGroup + MRM:Action + MRM:CountGroup:Count - 1,data)
b2 %>% all()
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM^Body2+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2
),steps=5000)
stp %>% all()
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2+
I((MRM/Weight*(Height-100)))
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2+
I((MRM/Weight*(Height-100)/100))
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2+
I((MRM/Weight*((Height-100)/100)^2))
),steps=5000)
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+MRM:Count+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^8)+
I((MRM/Index)^9)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2+
I((MRM/Weight*((Height-100)/100)^2))
),steps=5000)
stp %>% all()
stp=b2 %>% step(
direction = "both",
scope = (~.+
I(Count^2):CountGroup:MRM+
MRM:BodyType+
MRM:Body2+
MRM:I(Count^2)+
MRM:Count:BodyType+
MRM:Experience+
MRM:AgeGroup:Experience+
MRM:Count:Experience+
MRM:Count:CountGroup:BodyType+
MRM:CountGroup:BodyType+
MRM:Count:CountGroup:Body2+
MRM:CountGroup:Body2+
I(MRM*Count/Weight):CountGroup+
I(MRM*Weight/(Height-100))+
I((MRM-100)/MRM)+
poly(MRM/Weight,2)+
MRM+
MRM:Count+
MRM:Body2+
MRM:Action2+
MRM:Weight:BodyType+
I((MRM/Index)^2)+
I((MRM/Index)^3)+
I((MRM/Index)^4)+
I((MRM/Index)^5)+
I((MRM/Index)^6)+
I((MRM/Index)^7)+
I((MRM/Index)^8)+
I((MRM/Index)^9)+
I((MRM/Index)^0.5)+
log(MRM/Index)+
I(log(MRM/Index)^2)+
I((MRM/Index)^2):Body2+
I((MRM/Index)^2):Action2+
I((MRM/Weight*((Height-100)/100)^2))
),steps=5000)
b1 %>% all()
b1=lm(RM ~ MRM:Action + MRM:I(Count^2) + Action2:I(MRM/Weight) + MRM:Count:CountGroup - 1,data)
b1 %>% all()
tr=trainControl(method = "repeatedcv",
number = 10, #p = 0.75,
repeats = 30,
verboseIter = T,
returnResamp = "all", savePredictions = T,
summaryFunction = defaultSummary)
ft=train(RM~I((MRM/Index)^6) + MRM:CountGroup + MRM:Action + MRM:CountGroup:Count - 1,
data=data %>% select(-Mail,-Sex,-Age,-Height,-Weight),
method = "lmStepAIC",
scope=list(
upper=~.^3,
lower=~1),
direction="both",
metric =  "RMSE",
maximize = FALSE,
trControl = tr)
ft %>% predict(data) %>% Show()
ft %>% summary()
ft=train(RM~I((MRM/Index)^6) + MRM:CountGroup + MRM:Action + MRM:CountGroup:Count - 1,
data=data %>% select(-Mail,-Sex,-Age,-Height,-Weight),
method = "rf",
metric =  "RMSE",
maximize = FALSE,
trControl = tr)
