col_names=list("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")) %>% tbl_df()
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = list("f","d","d","n","f","f","f","n","n","n","f","f"),
col_names=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")) %>% tbl_df()
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "df"#,#list("f","d","d","n","f","f","f","n","n","n","f","f"),
#col_names=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")
) %>% tbl_df()
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"#,#list("f","d","d","n","f","f","f","n","n","n","f","f"),
#col_names=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")
) %>% tbl_df()
View(data)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff",
col_names=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")
) %>% tbl_df()
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")
View(data)
cbind(data$SM,data$Val*(1+0.0333*data$Count))
cbind(target=data$SM,value=data$Val*(1+0.0333*data$Count),type=data$Type)
md=nls(Sm~I(Val*(est+coef*Count)),data)
md=nls(SM~I(Val*(est+coef*Count)),data)
md=nls(SM~Val*(est+coef*Count),data,start = list(est=1,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),data,
start = list(est=1,coef=0.0333),
algorithm = "port")
md=nls(SM~Val*(est+coef*Count),data,
start = list(est=1,coef=0.0333),
algorithm = "plinear")
md=nls(SM~Val*(est+coef*Count),data,
start = list(est=0,coef=0.0333),
algorithm = "plinear")
md=nls(SM~Val*(est+coef*Count),data,
start = list(est=1.0,coef=0.0333),
algorithm = "plinear")
md=nls(SM~Val*(est+coef*Count),data=data,
start = list(est=1.0,coef=0.0333),
algorithm = "plinear")
md=nls(SM~Val*(est+coef*Count),data=data,
start = list(est=1.0,coef=0.0333))
DNase1 <- subset(DNase, Run == 1)
## using a selfStart model
fm1DNase1 <- nls(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase1)
summary(fm1DNase1)
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
predict(md,data$[3:4])
predict(md,data[3:4])
Error(data$SM,data$Val*(1+0.0333*data$Count))
Error=function(target,weigth) (target-weight)^2 %>% sum()
Error(data$SM,data$Val*(1+0.0333*data$Count))
Error=function(target,weigth) (target-weigth)^2 %>% sum()
Error(data$SM,data$Val*(1+0.0333*data$Count))
Error(data$SM,predict(md,data[3:4]))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=8.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=80.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=3.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=-3.0,coef=0.0333))
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=-3.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=-6575,coef=0.0333))
md=nls(SM~Val*(est+coef*Count/Weigth),
data=data,
start = list(est=1.0,coef=0.0333))
Error(data$SM,predict(md,data[c(3:4,9)]))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count*Weigth),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)/Weigth,
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
plot(data$Val)
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weigth","High","Body","Mail")
Error=function(target,weigth) (target-weigth)^2 %>% sum()
cbind(target=data$SM,value=data$Val*(1+0.0333*data$Count),type=data$Type)
Error(data$SM,data$Val*(1+0.0333*data$Count))
md=nls(SM~Val*(est+coef*Count)/Weigth,
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[3:4]))
md=nls(SM~Val*(est/Weigth+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)*Weigth,
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)*sqrt(Weigth),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)*exp(-Weigth),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
View(data)
md=nls(SM~Val*(est+coef*Count)*exp(-Weigth/10),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)*exp(-Weigth/100),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)*sqrt(Weigth),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
Error=function(target,weight) (target-weight)^2 %>% sum()
cbind(target=data$SM,value=data$Val*(1+0.0333*data$Count),type=data$Type)
Error(data$SM,data$Val*(1+0.0333*data$Count))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=0.1))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=0.01))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=0.000001))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=0.000001))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-0.000001))
md=nls(SM~Val*(est+coef*Count)-k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-0.001))
md=nls(SM~Val*(est+coef*Count)+k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-0.001))
md=nls(SM~Val*(est+coef*Count)+k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-0.1))
md=nls(SM~Val*(est+coef*Count)+k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-1))
md=nls(SM~Val*(est+coef*Count)+k*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-100))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-100))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=0))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=-10))
md=nls(SM~Val*(est+coef*Count)+k/Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=16))
md=nls(SM~Val*(est+coef*Count)*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)*Weight,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90),
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k*est,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k*est,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count)+(Weight-90)*k*est,
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count+(Weight-90)*k),
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count+(Weight-90)*k),
data=data,
start = list(est=1.0,coef=0.0333,k=1))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~sqrt(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~sqrt(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~log(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~log(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~log(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
md=nls(SM~log(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
Error=function(target,weight) (target-weight)^2 %>% sum()
cbind(target=data$SM,value=data$Val*(1+0.0333*data$Count),type=data$Type)
Error(data$SM,data$Val*(1+0.0333*data$Count))
md=lm(SM~Weight+Val:Count+Val,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[3:4]))
md=lm(SM~Weight+Val*Count,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count+Val,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count+Val+Type+Experience,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count+Val+Type+Experience-1,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
View(data)
md=lm(SM~Weight+Val:Count+Val+Experience-1,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count+Val-1,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Weight+Val:Count+Val,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
summary(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
cbind(target=data$SM,value=data$Val*(1+0.0333*data$Count),type=data$Type)
Error(data$SM,data$Val*(1+0.0333*data$Count))
md=lm(SM~Weight+Val:Count+Val,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=lm(SM~Val:Count+Val,data)
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~sqrt(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[c(3:4,9)]))
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Error(data$SM,predict(md,data[3:4]))
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
allrows=1:11
summary(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,data[rows,2:10]) %>% print()
cat("Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(Target-vals),data[rows,3:10]) %>% print()
cat("-----> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
data.frame(value=vals,Target=data$SM[rows],ERROR=abs(Target-vals),data[rows,3:10]) %>% print()
cat("-----> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
tibble(value=vals,Target=data$SM[rows],ERROR=abs(Target-vals),data[rows,3:10]) %>% print()
cat("-----> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,3:10]) %>% print()
cat("-----> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]),allrows)
md=nls(SM~sqrt(Val)*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
md=lm(SM~Val:Count+Val,data)
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
data %<>% mutate(CountGroup=cut(Count,breaks = c(2,4,8,12,15,25)))
View(data)
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,4,8,12,15,25)))
View(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:10,12)]) %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]),allrows)
md=lm(SM~Val:Count+Val+CountGroup-1,data)
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
View(data)
Show(predict(md,data[c(3:4,9,13)]),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data[c(3:4,9,13)]),allrows)
