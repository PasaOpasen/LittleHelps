p=ggplot(data %>% mutate(res=res),aes(x=CountGroup,y=res))+
geom_boxplot() +facet_grid(vars(Body),vars(Type))+theme_bw()
p
}
ResAn(data$SM-data$Val*(1+0.0333*data$Count))
ResVal=function(vals)ResAn(data$SM-vals)
#оптимизация чисто коэффициента
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]))
ResVal(predict(md,data[3:4]))
#оптимизация чисто коэффициента c поправкой на его группу
md=lm(I(SM/Val-1)~Val:Count:CountGroup-1,data)
summary(md)
Show((predict(md,data %>% select(Val,Count,CountGroup))+1)*data$Val)
ResVal((predict(md,data %>% select(Val,Count,CountGroup))+1)*data$Val)
#Val+Val*Count с поправкой на группу
md=lm(SM~Val:Count:CountGroup+Val:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count,CountGroup)))
ResVal(predict(md,data %>% select(Val,Count,CountGroup)))
md=step(md,
direction = "forward",
scope = (~
Val:Body+Val:Count:Body+
Val:Experience+Val:Count:Experience+
Val:Count:CountGroup:Body+Val:CountGroup:Body+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2)
))
summary(md)
Show(predict(md,data))
ResVal(predict(md,data %>% select(Val,Count,CountGroup)))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(
CountGroup=cut(Count,breaks = c(1,3,7,12,20,30))
)%>% select(-Date,-Mail)
levels(data$CountGroup)=c("2-3","4-7","8-12","13-20",">20")
allrows=1:nrow(data)
#Val+Val*Count с поправкой на группу
md=lm(SM~Val:Count:CountGroup+Val:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count,CountGroup)))
ResVal(predict(md,data %>% select(Val,Count,CountGroup)))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(
CountGroup=cut(Count,breaks = c(1,3,7,12,20,30))
)%>% select(-Date,-Mail)
levels(data$CountGroup)
getPIE=function(vec,main=""){
ln=length(levels(vec))
x=numeric(ln)
ns=character(ln)
for(i in seq(ln)){
x[i]=sum(vec==levels(vec)[i])/length(vec)
ns[i]=paste0(levels(vec)[i]," (",round(x[i]*100,2),"%)")
}
pie(x=x,labels=ns,main=main)
}
par(mfrow=c(3,1),mai=rep(0.1,4))
getPIE(data$CountGroup,main = "Диапазон повторений")
getPIE(data$Experience,main = "Опыт тренировок")
getPIE(data$Type,main = "Движение")
par(mfrow=c(1,1),mai=rep(0.1,4))
levels(data$CountGroup)=c("2-3","4-7","8-12","13-20",">20")
par(mfrow=c(3,1),mai=rep(0.1,4))
getPIE(data$CountGroup,main = "Диапазон повторений")
getPIE(data$Experience,main = "Опыт тренировок")
getPIE(data$Type,main = "Движение")
par(mfrow=c(1,1),mai=rep(0.1,4))
par(mfrow=c(1,3),mai=rep(0.1,4))
getPIE(data$CountGroup,main = "Диапазон повторений")
getPIE(data$Experience,main = "Опыт тренировок")
getPIE(data$Type,main = "Движение")
par(mfrow=c(1,1),mai=rep(0.1,4))
par(mfrow=c(3,1),mai=rep(0.1,4))
getPIE(data$CountGroup,main = "Диапазон повторений")
getPIE(data$Experience,main = "Опыт тренировок")
getPIE(data$Type,main = "Движение")
par(mfrow=c(1,1),mai=rep(0.1,4))
chisq.test(data%>% filter(Sex=="Мужчина") %>%select(Body) %>% table())
par(mfrow=c(2,2),mai=rep(0.1,4))
getPIE(data$Sex,main = "Пол испытуемых")
getPIE(data$Body,main = "Телосложение испытуемых")
getPIE(data %>% filter(Sex=="Мужчина") %$% Body,main = "Телосложение: мужчины")
getPIE(data%>% filter(Sex=="Женщина") %$% Body,main = "Телосложение: женщины")
mx=function(vals,count, withcomp=T){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
if(withcomp){
s=t[length(t)]*(1+runif(1,0.,0.005))
return(c(t,s))
}
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx(x,y,F),mx(x+8,y,F),mx(x+15,y,F))
lb=paste0(c(x,vc[12],x+8,vc[24],x+15,vc[16]) %>% round(),"x",c(y,y,y))
#Загрузка данных####
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggthemes)
library(tidyquant)
library(ggvis)
#155 верхошанский
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx(x,y,F),mx(x+8,y,F),mx(x+15,y,F))
lb=paste0(c(x,vc[12],x+8,vc[24],x+15,vc[16]) %>% round(),"x",c(y,y,y))
plot(vc,type = "b")
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+
library(ggformula)
library(ggalt)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
lb=paste0(c(xx+8,x+15) %>% round(),"x",c(y,y,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
lb=paste0(c(x,x+8,x+15) %>% round(),"x",c(y,y,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 155, label = "Начальные результаты") +
annotate("text", x = 17, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
#155 верхошанский
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx(x,y,F),mx(x+8,y,F),mx(x+15,y,F))
lb=paste0(c(x,x+8,x+15) %>% round(),"x",c(y,y,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x))==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 155, label = "Начальные результаты") +
annotate("text", x = 17, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 9, y = 158, label = "Начальные результаты") +
annotate("text", x = 9, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 5, y = 158, label = "Начальные результаты") +
annotate("text", x = 5, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 5, y = 158, label = "Начальные результаты") +
annotate("text", x = 4, y = 177, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 4, y = 160, label = "Начальные результаты") +
annotate("text", x = 4, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%12!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
#155 верхошанский
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx(x,y,F),mx(x+8,y,F),mx(x+15,y,F))
lb=paste0(c(x,x+8,x+15) %>% round(),"x",c(y,y,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%length(x)!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%length(x)!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.2,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3.5, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%length(x)!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3.5, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%length(x)!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
x=c(112,112,117,122,126,131,136,141,145,150,155,160,166,177,122.5,122.5,128,133,138,143,149,154,159,165,170,175,182,195,136,136,142,148,154,160,165,171,177,183,190,195,203,216)
y=rep(c(10,10,8,8,5,5,5,5,3,3,2,2,1,1),3)
vc=c(mx(x,y,F))
plot(vc,type = "b")
ct=length(y)/3
x=c(112,112,117,122,126,131,136,141,145,150,155,160,166,177,122.5,122.5,128,133,138,143,149,154,159,165,170,175,182,195,136,136,142,148,154,160,165,171,177,183,190,195,203,216)
y=rep(c(10,10,8,8,5,5,5,5,3,3,2,2,1,1),3)
vc=c(mx(x,y,F))
ct=length(y)/3
plot(vc,type = "b")
lb=paste0(x ,"x", y)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%ct==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 160,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3.5, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%ct!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
x=c(112,112,117,122,126,131,136,141,145,150,155,160,166,177,122.5,122.5,128,133,138,143,149,154,159,165,170,175,182,195,131,136,142,148,154,160,165,171,177,183,190,195,203,216)
y=rep(c(10,10,8,8,5,5,5,5,3,3,2,2,1,1),3)
vc=c(mx(x,y,F))
ct=length(y)/3
plot(vc,type = "b")
lb=paste0(x ,"x", y)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%ct==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 160,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 35, y = 159, label = "Начальные результаты") +
annotate("text", x = 35, y = 210, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%ct!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.1))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 160,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 35, y = 162, label = "Начальные результаты") +
annotate("text", x = 35, y = 214, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%ct!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.1))#+ guides(color=FALSE)
x=c(110,112,117,122,126,131,136,141,145,150,155,160,166,177,120,122.5,128,133,138,143,149,154,159,165,170,175,182,195,134,136,142,148,154,160,165,171,177,183,190,195,203,216)
y=rep(c(10,10,8,8,5,5,5,5,3,3,2,2,1,1),3)
vc=c(mx(x,y,F))
ct=length(y)/3
plot(vc,type = "b")
lb=paste0(x ,"x", y)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%ct==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 160,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 35, y = 162, label = "Начальные результаты") +
annotate("text", x = 35, y = 214, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%ct!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.1))#+ guides(color=FALSE)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 160,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 35, y = 162, label = "Начальные результаты") +
annotate("text", x = 35, y = 214, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%ct!=0,0.8,0.3), label = lb) +
labs(title='Тягловый цикл Тома Маккелоу (три прохода)',
subtitle="Колебание, подъём, колебание, проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.1))#+ guides(color=FALSE
#155 верхошанский
x=c(100,125,107.5,132.5,120,140,127.5,147.5,117.5,132.5,125,162.5)
y=c(6,5,5,4,3,3,3,2,5,2,2,1)
vc=c(mx(x,y,F),mx(x+8,y,F),mx(x+15,y,F))
lb=paste0(c(x,x+8,x+15) %>% round(),"x",c(y,y,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%length(x)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 155,size=1.,linetype="dashed",alpha=0.7)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.7)+
geom_xspline(size=1,spline_shape = -0.7,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 3.5, y = 159, label = "Начальные результаты") +
annotate("text", x = 3, y = 176, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%length(x)!=0,0.8,0.3), label = lb) +
labs(title='Пиковый цикл Верхошанского (три прохода)',
subtitle="Медленный подъём чуть выше бывшего максимума, затем отдых и проходка",
x="Номер тренировки",
y="Требуемое усилие",
caption="Файл с циклом прилагается") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+theme(legend.position = c(0.85,0.15))#+ guides(color=FALSE)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(
CountGroup=cut(Count,breaks = c(1,3,7,12,20,30))
)%>% select(-Date,-Mail)
levels(data$CountGroup)=c("2-3","4-7","8-12","13-20",">20")
allrows=1:nrow(data)
summary(data)
GGally::ggcorr(data)
data[sapply(data, is.numeric)]%>% cor()%>% corrplot::corrplot(method = "number")
GGally::ggcorr(data,label=T)
GGally::ggcorr(data,label=T,label_round = 2)
data %$% cor(SM,Val*Count)
obj=ggplot(data %>% select(-Count))+theme_bw()
bx=obj+geom_boxplot(aes(x=CountGroup,y=SM/Val))+
labs(title = "Отношение повторного максимума к многоповторному в зависимости от числа повторений",
x="Диапазон повторений",y="Отношение повторного максимума к многоповторному",
caption = "Каждый диапазон повторений действует по своим законам \n и нуждается в собственной версии модели")+
theme_tq()
bx
