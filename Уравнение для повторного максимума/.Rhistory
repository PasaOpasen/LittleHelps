summary(data)
pairs(data %>% select(-Date,-Mail))
GGally::ggpairs(data %>% select(-Date,-Mail))
data[sapply(data, is.numeric)]%>% cor()%>% corrplot::corrplot(method = "number")
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
allrows=1:length(data)
allrows=1:nrow(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)))
allrows=1:nrow(data)
summary(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data[c(3:4,9,13)]),allrows)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
pr=predict(md,data[c(3:4,9,13)], interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)))
allrows=1:nrow(data)
summary(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=nls(SM~Val*(est+coef*Count),
data=data,
start = list(est=1.0,coef=0.0333))
summary(md)
Show(predict(md,data[c(3:4,9)]),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data[c(3:4,9,13)]),allrows)
plot(md)
md=lm(SM~Val:Count+Val-1+I(Val^2/Weight),data)
summary(md)
md=lm(SM~Val:Count+Val-1+I(Val^2),data)
summary(md)
md=lm(SM~Val:Count+Val-1+I((Val-Weight)^2),data)
summary(md)
md=lm(SM~Val:Count+Val-1+I(Weight/(High-100)),data)
summary(md)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100)),data)
summary(md)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data[c(3:4,9,13)]),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100)),data)
summary(md)
Show(predict(md,data[c(3:4,9,13)]),allrows)
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100)),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I(Val/Count),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I(Val/Count/Weight),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I(Val/Weight),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I(Val/Count/(Val-100)),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Count/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
pr=predict(md,data[c(3:4,9,13)], interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
plot(md)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(sqrt(SM)~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(sqrt(SM)~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)^2),allrows)
md=lm(sqrt(SM)~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High))^2,allrows)
md=lm(SM~Val:Count+Val-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val+Val:Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
#Загрузка данных####
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)))
allrows=1:nrow(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],ERROR=abs(data$SM[rows]-vals),data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val)+I((Val/Weight)^2),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val)+I(((Val-100)/Weight)^2),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val)),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
#Загрузка данных####
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)))
allrows=1:nrow(data)
#Разведочный анализ и описание выборки####
summary(data)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ERRORproc=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
Show(data$Val*(1+0.0333*data$Count),allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
#Загрузка данных####
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)),ValCoef=Val/Weight,SMcoef=SM/Weight)
allrows=1:nrow(data)
data
md=lm(SM~Val:Count+Val-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count)),allrows)
md=lm(SMcoef~ValCoef:Count+ValCoef-1,data)
summary(md)
Show(predict(md,data %>% select(ValCoef,Count))*data$Weight,allrows)
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
pr=predict(md,data[c(3:4,9,13)], interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
pr=predict(md,data[c(3:4,9,13)], interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
getPIE=function(vec,main=""){
ln=length(levels(vec))
x=numeric(ln)
ns=character(ln)
for(i in seq(ln)){
x[i]=sum(vec==levels(vec)[i])/length(vec)
ns[i]=paste0(levels(vec)[i]," (",round(x[i]*100,2),"%)")
}
pie(x=x,labels=ns,main=main)
}
getPIE(data$Body)
getPIE(data$CountGroup)
getPIE(data$Experience)
getPIE(factor(data$Count))
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
obj+geom_bar(aes(x=CountGroup))
obj+geom_bar(aes(x=Body))
obj+geom_boxplot(aes(x=Type,y=SM))
GGally::ggpairs(data %>% select(-Date,-Mail))
#Загрузка данных####
library(tidyverse)
library(magrittr)
data=read_tsv("data.tsv",
skip=1,col_names = F,na="",
col_types = "fddnfffnnnff"
) %>% tbl_df()
colnames(data)=c("Date","SM","Val","Count","Type","Sex","Experience","Age","Weight","High","Body","Mail")
data %<>% mutate(CountGroup=cut(Count,breaks = c(1,3,6,9,12,20,30)),ValCoef=Val/Weight,SMcoef=SM/Weight)
allrows=1:nrow(data)
obj=ggplot(data %>% select(-Date,-Mail))+theme_bw()
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
Error=function(target,weight) (target-weight)^2 %>% sum()
Show=function(vals,rows){
cbind(value=vals,Target=data$SM[rows],
ERROR=abs(data$SM[rows]-vals),ErrorPercent=abs(data$SM[rows]-vals)/data$SM[rows]*100,
data[rows,c(3:11,13)]) %>% tbl_df() %>% print()
cat("---------------------> Error is",Error(vals,data$SM[rows]),"\n")
}
md=lm(SM~Val:Count+Val*Body-1+I(Val*Weight/(High-100))+I((Val-100)/Val),data)
summary(md)
Show(predict(md,data%>% select(Val,Count,Weight,High,Body)),allrows)
p=prcomp(~Val+Count+High+Weight,data)
summary(p)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
install.packages("ggformula")
library(ggformula)
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1,spar=0.2)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1,spar=0.4)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1,spar=0.02)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1,spar=0.02,cv=T)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_spline(aes(x=Val,y=pr[,1]),size=1,spar=0.02,cv=F)+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body)))
View(d2)
#Рассмотрение остатков####
d2=data %>% mutate(res=SM-predict(md,data%>% select(Val,Count,Weight,High,Body))) %>% select(-Date,-Mail)
View(d2)
ob=ggplot(d2,aes(y=res))
ob+geom_boxplot(aes(x=Type))
ob+geom_boxplot(aes(x=Body))
ob+geom_histogram()
ob+geom_histogram(aes(x=Val))
ob+geom_bar(aes(x=allrows))
ob+geom_bar(aes(x=factor(allrows)))
ob+geom_point(aes(x=allrows))
ob+geom_point(aes(x=allrows,col=factor(ifelse(abs(y)>2,"red","green"))))
ob+geom_point(aes(x=allrows,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,size=4,col=factor(ifelse(abs(res)>2,"red","green"))))
ob+geom_point(aes(x=allrows,shape=Body,col=factor(ifelse(abs(res)>2,"red","green"))),size=4)
ob+geom_boxplot(aes(x=Body))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.3))
ggplot(d2,aes(SM))+geom_line()
ggplot(d2,aes(x=allrows,y=SM))+geom_line()
mx=function(vals,count){
t=val*(1+0.0333*count)
t[count==1]=val[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,5,4)
mx(x,y)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,5,4)
mx(x,y)
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
return(t)
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
mx(x,y)
vc=c(mx(x,y),mx(x+5,y))
plot(vc)
vc
library(tidyverse)
library(magrittr)
library(ggformula)
tb=tibble(d=1:length(vc),val=vc)
ggplot(tb,aes(x=d,y=val))+
geom_spline()+
geom_point()
ggplot(tb,aes(x=d,y=val))+
geom_spline(spar=0.8)+
geom_point(size=3)
ggplot(tb,aes(x=d,y=val))+
geom_spline(spar=0.1)+
geom_point(size=3)
f=spline(vc)
spline()
f
f=spline(vc,n=40)
ggplot(tb,aes(x=d,y=val))+
geom_line(aes(x=f$x,y=f$y))+
geom_point(size=3)
ggplot(tb)+
geom_line(aes(x=f$x,y=f$y))+
geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=f$x,y=f$y))#+
#geom_point(aes(x=d,y=val),size=3)
f$x
f$y
tb=tibble(f)
View(tb)
tb=tibble(x=f$x,y=f$y)
ggplot(tb)+
geom_line(aes(x=x,y=y))#+
#geom_point(aes(x=d,y=val),size=3)
f=spline(vc,n=40)
tb=tibble(d=f$x,val=f$y)
ggplot(tb)+
geom_line(aes(x=d,y=val))#+
#geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
#geom_point(aes(x=d,y=val),size=3)
tb=tibble(d=f$x,val=f$y,day=ifelse(d==1:length(vc),1,0))
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
geom_point(aes(x=d,y=val),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=2)#+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
View(tb)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)#+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,col=factor(day)),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=1:length(vc),y=vc),size=3)
ggplot()+
geom_line(tb,aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=1:length(vc),y=vc),size=3)
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day)))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2)))
f=spline(vc,n=40,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2)))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(day,levels = c("green","red"))))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=60,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=50,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=20,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=40,method="periodic")
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
f=spline(vc,n=40)
tb=tibble(d=f$x,val=f$y,day=ifelse(d %in% 1:length(vc),1,0))
ggplot(tb)+
geom_line(aes(x=d,y=val),col="green",size=1.3)+
geom_point(aes(x=d,y=val,size=factor(day/2),col=factor(ifelse(day==1,"red","green"))))
