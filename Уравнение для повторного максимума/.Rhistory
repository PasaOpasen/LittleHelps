cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
Show=function(vals,df=data){
cbind(value=vals,Target=df$SM,
ERROR=abs(df$SM-vals),
ErrorPercent=abs(df$SM-vals)/df$SM*100,
df[,c(3:11,13)]) %>% tbl_df()%>% arrange(ERROR,ErrorPercent,Count,Weight) %>% print()
print("")
cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
Show=function(vals,df=data){
cbind(value=vals,Target=df$SM,
ERROR=abs(df$SM-vals),
ErrorPercent=abs(df$SM-vals)/df$SM*100,
df[,c(3:11,13)]) %>% tbl_df()%>% arrange(ERROR,ErrorPercent,Count,Weight) %>% print()
cat("\n")
rg=range(df$SM-vals)
cat("-------------------> Наибольшая ошибка в меньшую сторону:",rg[1],"\n")
cat("-------------------> Наибольшая ошибка в большую сторону:",rg[2],"\n")
cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
Show=function(vals,df=data){
cbind(value=vals,Target=df$SM,
ERROR=abs(df$SM-vals),
ErrorPercent=abs(df$SM-vals)/df$SM*100,
df[,c(3:11,13)]) %>% tbl_df()%>% arrange(ERROR,ErrorPercent,Count,Weight) %>% print()
cat("\n")
rg=range(df$SM-vals)
if(rg[1]<0)cat("-------------------> Наибольшая ошибка в меньшую сторону:",-rg[1],"\n")
if(rg[2]>0)cat("-------------------> Наибольшая ошибка в большую сторону:",rg[2],"\n")
cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
#оптимизация чисто коэффициента
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]))
#начальная
Show(data$Val*(1+0.0333*data$Count))
Show=function(vals,df=data){
cbind(value=vals,Target=df$SM,
ERROR=abs(df$SM-vals),
ErrorPercent=abs(df$SM-vals)/df$SM*100,
df[,c(3:11,13)]) %>% tbl_df()%>% arrange(ERROR,ErrorPercent,Count,Weight) %>% print()
cat("\n")
rg=range(df$SM-vals)
if(rg[1]<0)cat("-------------------> Наибольшая ошибка в меньшую сторону:",-rg[1],"\n")
if(rg[2]>0)cat("-------------------> Наибольшая ошибка в большую сторону:",rg[2],"\n")
cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
Show=function(vals,df=data){
cbind(value=vals,Target=df$SM,
ERROR=abs(df$SM-vals),
ErrorPercent=abs(df$SM-vals)/df$SM*100,
df[,c(3:11,13)]) %>% tbl_df()%>% arrange(ERROR,ErrorPercent,Count,Weight) %>% print()
cat("\n")
rg=range(df$SM-vals)
if(rg[1]<0)cat("-------------------> Наибольшая ошибка в большую сторону:",-rg[1],"\n")
if(rg[2]>0)cat("-------------------> Наибольшая ошибка в меньшую сторону:",rg[2],"\n")
cat("-------------------> Среднеквадратичная ошибка:",Error(vals,df$SM),"\n")
}
#Модели####
#начальная
Show(data$Val*(1+0.0333*data$Count))
#оптимизация чисто коэффициента
md=nls(SM~Val*(1+coef*Count),
data=data,
start = list(coef=0.0333))
summary(md)
Show(predict(md,data[3:4]))
#оптимизация чисто коэффициента c поправкой на его группу
md=lm(I(SM/Val-1)~Val:Count:CountGroup,data)
summary(md)
Show((predict(md,data %>% select(Val,Count,CountGroup))+1)*data$Val)
#Val+Val*Count с поправкой на группу
md=lm(SM~Val:Count:CountGroup+Val:CountGroup-1,data)
summary(md)
Show(predict(md,data %>% select(Val,Count,CountGroup)))
car::vif(md)
plot(md)
Show(predict(md,data))
md=step(md,
direction = "both",
scope = (~Val+Val:Count+
Val:Body+Val:Count:Body+
Val:Experience+Val:Count:Experience+
Val:Count:CountGroup:Body+Val:CountGroup:Body+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2)))
summary(md)
Show(predict(md,data))
md=step(md,
direction = "forward",
scope = (~Val+Val:Count+
Val:Body+Val:Count:Body+
Val:Experience+Val:Count:Experience+
Val:Count:CountGroup:Body+Val:CountGroup:Body+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2)
))
md=step(md,
direction = "forward",
scope = (~
Val:Body+Val:Count:Body+
Val:Experience+Val:Count:Experience+
Val:Count:CountGroup:Body+Val:CountGroup:Body+
I(Val*Weight/(High-100))+
I((Val-100)/Val)+poly(Val/Weight,2)
))
pr=predict(md,data%>% select(Val,Count,Weight,High,Body,Sex,Experience,CountGroup), interval = "prediction", level = 0.95)
obj+
#geom_ribbon(aes(x=Val,ymin = pr[,2], ymax = pr[,3]), fill = "grey70") +
geom_line(aes(x=Val,y=pr[,1]),size=1,col="grey70",linetype="dotted")+
geom_point(aes(x=Val,y=pr[,1]),size=3)+
geom_point(aes(x=Val,y=SM,col=Body,shape=Type),size=4)+theme(legend.position = c(0.85,0.25))
#простой цикл####
mx=function(vals,count){
t=vals*(1+0.0333*count)
t[count==1]=vals[count==1]
s=t[length(t)]*(1+runif(1,0.,0.005))
return(c(t,s))
}
x=c(100,120,115,105,130,120,125)
y=c(10,4,6,10,3,6,5)
vc=c(mx(x,y),mx(x+4,y),mx(x+9,y))
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
library(tidyverse)
library(magrittr)
library(ggformula)
library(ggalt)
tb=tibble(d=1:length(vc),val=vc) %>% mutate(day=factor(ifelse(d%%(length(x)+1)==0,"проходка","тренировка")))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_bw(legend.position = c(0.85,0.25))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme(legend.position = c(0.85,0.25))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+theme_light(legend.position = c(0.85,0.25))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
theme(legend.position = c(0.85,0.25),
legend.justification = c("right", "top"),
legend.box.just = "right")
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 20, y = 142, label = "Начальные возможности") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 22, y = 141, label = "Начальные возможности") +
annotate("text", x = 15, y = 156, label = "Начальные возможности") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 15, y = 156, label = "Итоговые результаты") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 16, y = 155, label = "Итоговые результаты") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 16, y = 155.5, label = "Итоговые результаты") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.1,linetype="dashed")+
geom_hline(yintercept = vc[length(vc)],size=1.1,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed")+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle=lmlab,
caption="Source: mtcars") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw(legend.position = "bottom"))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw(legend.position = "bottom")
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = d+1, y = val-1, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+1, y = tb$val-1, label = "Итоговые результаты") +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
lb=paste0(c(x,x+4,x+9),"x",rep(y,3))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+1, y = tb$val-1, label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
lb=paste0(c(x,vc[8],x+4,vc[16],x+9,vc[24]),"x",c(y,1,y,1,y,1))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+1, y = tb$val-1, label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
lb=paste0(c(x,vc[8],x+4,vc[16],x+9,vc[24]) %>% round(),"x",c(y,1,y,1,y,1))
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.5, y = tb$val-1, label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
seq(tb$d)
seq(tb$d)%%8==0
tb$val-ifelse(seq(tb$d)%%8==0,1,0.5)
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.5, y = tb$val-ifelse(seq(tb$d)%%8==0,1,0.5), label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
-ifelse(seq(tb$d)%%8==0,1,0.5)
seq(tb$d)%%8
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.5, y = tb$val-ifelse(seq(tb$d)%%8!=0,1,0.5), label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Linear Regression Example',
subtitle="lmlab",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла на повышение',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
xlab="Номер тренировки",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
caption="Source: mtcars") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.5, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Не используйте такой цикл больше 2-3 проходов подряд, он может привести к перетренированности") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 142.2, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Не используйте такой цикл больше 2-3 проходов подряд, он может привести к перетренированности") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Не используйте такой цикл больше 2-3 проходов подряд, он может привести к перетренированности") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()
ggplot(tb,aes(x=d,y=val))+
geom_hline(yintercept = 141,size=1.,linetype="dashed",alpha=0.8)+
geom_hline(yintercept = vc[length(vc)],size=1.,linetype="dashed",alpha=0.8)+
geom_xspline(size=1,spline_shape = -0.3,linetype="dotdash",col="green",alpha=0.9)+
geom_point(aes(col=day),size=4)+
annotate("text", x = 21, y = 141.7, label = "Начальные результаты") +
annotate("text", x = 17, y = 155.7, label = "Итоговые результаты") +
annotate("text", x = tb$d+0.4, y = tb$val-ifelse(seq(tb$d)%%8!=0,0.8,0.3), label = lb) +
labs(title='Динамика простого цикла (три прохода)',
subtitle="Использование модели помогает отследить прогрессию нагрузок",
x="Номер тренировки",
y="Требуемое усилие",
caption="Не используйте такой цикл больше 2-3 проходов подряд, он может привести к перетренированности") +
guides(color=guide_legend(title="Тип дня"))+
theme_bw()+ guides(color=FALSE)
